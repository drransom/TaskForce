

<% var times, date, day, month, day_num, year, date_str, time, activities %>
<% var taskerName, buttonText, buttonClass, offsetClass, tooltip %>

<% activities = { "moving": "Help moving", "military": "Defeat my enemies" } %>

<% times = ["any time", "morning", "afternoon", "evening"] %>

<% date = (new Date(model.get('date'))).toDateString().split(' ') %>
<% day = date[0] %>
<% month = date[1] %>
<% day_num = date[2] %>
<% year = date[3] %>
<% date_str = day + " " + month + " " + day_num + ", " + year %>
<% time = times[model.get('time')] %>
<% taskerName = (function () { %>
  <% if (model.get('tasker_name')) { %>
    <% return model.get('tasker_name') %>
  <% } else { %>
    <% return "No Tasker Assigned Yet" %>
  <% } %>
<% })() %>

<% tooltip = "data-toggle='tooltip' data-delay='100' title='change rating' data-placement='left'" %>

<% if (!model.get('user_completed')) { %>
  <% buttonText = "Mark complete" %>
  <% buttonClass = "btn-default btn-std-color mark-complete mini-task-button" %>
<% } else if (model.get('rating') === 0) { %>
  <% buttonText = "Rate Tasker" %>
  <% buttonClass = "btn-default btn-alt-color rate-tasker mini-task-button" %>
<% } else if (model.get('rating') > 0 ) { %>
  <% buttonText = "<span class='glyphicon glyphicon-thumbs-up' " + tooltip + "></span>" %>
  <% buttonClass = "tasker-rated " %>
<% } else { %>
  <% buttonText = "<span class='glyphicon glyphicon-thumbs-down' " + tooltip + "></span>" %>
  <% buttonClass = "tasker-rated " %>
<% } %>

<% if (tasker.get('alive')) { %>
  <% var taskerDead = "" %>
<% } else { %>
 <% var taskerDead = "tasker-dead" %>
<% } %>

<div class="col-md-4">
  <div class="column-padding">
    <div class="mini-task">
      <ul class="list-group mini-task-list">
        <li class="list-group-item mini-task-item"><%= activities[model.get('category')] %></li>
        <li class="list-group-item mini-task-item"><%= model.get('description') %></li>
        <li class="list-group-item mini-task-item">Tasker: <span class="<%= taskerDead %>"><a href="javascript:void(0)" class="tasker-profile"><%= taskerName %></a></span></li>
        <li class="list-group-item date-time mini-task-item"><span class="text-left"><%=date_str %></span><span class="pull-right"><%= time %></span></li>
      </ul>
      <button type="button" class="btn <%= buttonClass %>"
        data-id="<%= model.get('id')%>"><%= buttonText %></button><br>
    </div>
  </div>
</div>
